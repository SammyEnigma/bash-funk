# Bash-Funk "memory" module

[//]: # (THIS FILE IS GENERATED BY BASH-FUNK GENERATOR)

The following commands are available when this module is loaded:

1. [-alloc-mem](#-alloc-mem)
1. [-memfree](#-memfree)
1. [-meminfo](#-meminfo)
1. [-memtotal](#-memtotal)
1. [-test-memory](#-test-memory)

## <a name="-alloc-mem"></a>-alloc-mem

```
Usage: -alloc-mem [OPTION]... MEMORY_IN_MB

Allocates the given amount of RAM.

Requirements:
  + Command 'python' must be available.

Parameters:
  MEMORY_IN_MB (required, integer: 1-?)
      Amount of RAM in MB to allocate.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.
```

*Implementation:*
```bash
echo -n "Allocating ${_MEMORY_IN_MB} MB of memory (may take a moment)..."
python -c "
a='1'*1024*1024*${_MEMORY_IN_MB}
print 'DONE'
raw_input('Press enter to exit...')
"
```


## <a name="-memfree"></a>-memfree

```
Usage: -memfree [OPTION]... [MEMORY_UNIT]

Prints the free memory (in KB by default).

Parameters:
  MEMORY_UNIT (default: 'KB', one of: [KB,MB,GB])
      The memory unit of the printed value.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -memfree 
1036560
$ -memfree MB
1012
$ -memfree GB
1
```

*Implementation:*
```bash
local totalMem=$(awk '/MemFree/ {print $2}' /proc/meminfo)
local totalMemUnit=$(awk '/MemFree/ {print $3}' /proc/meminfo)

case ${totalMemUnit} in
    [Kk][Bb])
        local memTotalKB=$totalMem
        ;;
    [Mm][Bb])
        local memTotalKB=$(( totalMem * 1024 ))
        ;;
    [Gg][Bb])
        local memTotalKB=$(( totalMem * 1024 * 1024 ))
        ;;
    *)
        echo "Error: Unsupported memory unit ${totalMemUnit} encountered."
        return 1
        ;;
esac

case $_MEMORY_UNIT in
    KB)
        echo $memTotalKB
        ;;
    MB)
        echo $(( memTotalKB / 1024 ))
        ;;
    GB)
        echo $(( memTotalKB / 1024 / 1024 ))
        ;;
esac
```


## <a name="-meminfo"></a>-meminfo

```
Usage: -meminfo [OPTION]...

Prints memory information from /proc/meminfo.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -meminfo
```

*Implementation:*
```bash
cat /proc/meminfo
```


## <a name="-memtotal"></a>-memtotal

```
Usage: -memtotal [OPTION]... [MEMORY_UNIT]

Prints the total memory (in KB by default).

Parameters:
  MEMORY_UNIT (default: 'KB', one of: [KB,MB,GB])
      The memory unit of the printed value.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -memtotal 
1036560
$ -memtotal MB
1012
$ -memtotal GB
1
```

*Implementation:*
```bash
local totalMem=$(awk '/MemTotal/ {print $2}' /proc/meminfo)
local totalMemUnit=$(awk '/MemTotal/ {print $3}' /proc/meminfo)

case ${totalMemUnit} in
    [Kk][Bb])
        local memTotalKB=$totalMem
        ;;
    [Mm][Bb])
        local memTotalKB=$(( totalMem * 1024 ))
        ;;
    [Gg][Bb])
        local memTotalKB=$(( totalMem * 1024 * 1024 ))
        ;;
    *)
        echo "Error: Unsupported memory unit ${totalMemUnit} encountered."
        return 1
        ;;
esac

case $_MEMORY_UNIT in
    KB)
        echo $memTotalKB
        ;;
    MB)
        echo $(( memTotalKB / 1024 ))
        ;;
    GB)
        echo $(( memTotalKB / 1024 / 1024 ))
        ;;
esac
```


## <a name="-test-memory"></a>-test-memory

```
Usage: -test-memory [OPTION]...

Performs a selftest of all functions of this module by executing each function with option '--selftest'.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.
```

*Implementation:*
```bash
-alloc-mem --selftest && echo || return 1
-memfree --selftest && echo || return 1
-meminfo --selftest && echo || return 1
-memtotal --selftest && echo || return 1
```


## <a name="license"></a>License

Copyright (c) 2015-2017 Vegard IT GmbH, http://vegardit.com

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

