# Bash-Funk "strings" module

[//]: # (THIS FILE IS GENERATED BY BASH-FUNK GENERATOR)

The following commands are available when this module is loaded:

1. [-ascii2hex](#-ascii2hex)
1. [-hex2ascii](#-hex2ascii)
1. [-normalize-path](#-normalize-path)
1. [-str-join](#-str-join)
1. [-str-lower](#-str-lower)
1. [-str-matches](#-str-matches)
1. [-str-repeat](#-str-repeat)
1. [-str-trim](#-str-trim)
1. [-str-upper](#-str-upper)
1. [-strip-ansi](#-strip-ansi)
1. [-substr-after](#-substr-after)
1. [-substr-after-last](#-substr-after-last)
1. [-substr-before](#-substr-before)
1. [-substr-before-last](#-substr-before-last)
1. [-substr-between](#-substr-between)
1. [-test-strings](#-test-strings)
1. [License](#license)


## <a name="-ascii2hex"></a>-ascii2hex

```
Usage: -ascii2hex [OPTION]... ASCII_STRING

Prints the hexa-decimal representation of the given ASCII string.

Parameters:
  ASCII_STRING (required)
      The ASCII string to convert.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -ascii2hex XYZ
58595A
```

*Implementation:*
```bash
printf "${_ASCII_STRING}" | xxd -p | tr "[a-z]" "[A-z]"
```


## <a name="-hex2ascii"></a>-hex2ascii

```
Usage: -hex2ascii [OPTION]... HEX_STRING

Prints the ASCII representation of the given hexa-decimal string.

Parameters:
  HEX_STRING (required)
      The hexa-decimal string to convert.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -hex2ascii 58595A
XYZ
```

*Implementation:*
```bash
printf "${_HEX_STRING}" | xxd -r -p
```


## <a name="-normalize-path"></a>-normalize-path

```
Usage: -normalize-path [OPTION]... PATH

Prints the normalized form of the given file path.

Parameters:
  PATH (required)
      The path to normalize.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -normalize-path a/./b/c/d/../e
a/b/c/e
```

*Implementation:*
```bash
# Remove all occurrences of "/./"
local normalized=${_PATH//\/.\//\/}

# Remove all occurrences of "dir/.."
while [[ ${normalized} =~ [^\/][^\/]*\/\.\.\/ ]]; do
    normalized=${normalized/${BASH_REMATCH[0]}/}
done
echo $normalized
```


## <a name="-str-join"></a>-str-join

```
Usage: -str-join [OPTION]... SEPARATOR [STRING]...

Prints strings joined with the given separator.

Parameters:
  SEPARATOR (required)
      The separator to join the strings.
  STRING (0 or more)
      The strings to join.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -str-join , a b c
a,b,c
$ -str-join , a 
a
$ -str-join , 
```

*Implementation:*
```bash
if [[ ${#_STRING[@]} -lt 1 ]]; then
    return 0;
fi
local firstItem=${_STRING[0]}
if [[ ${#_STRING[@]} -lt 2 ]]; then
    echo $firstItem
    return 0;
fi
local additionalItems=("${_STRING[@]:1}")
printf "%s" "$firstItem${additionalItems[@]/#/$_SEPARATOR}"
```


## <a name="-str-lower"></a>-str-lower

```
Usage: -str-lower [OPTION]... STRING

Prints the given string in lower cases.

Parameters:
  STRING (required)
      The string to convert.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -str-lower aBcDeF
abcdef
```

*Implementation:*
```bash
echo "${_STRING,,}"
```


## <a name="-str-matches"></a>-str-matches

```
Usage: -str-matches [OPTION]... REGEX_PATTERN [STRING]...

Matches the given string(s) against the regex pattern, prints the found matches and returns true if at least one match was found.

Parameters:
  REGEX_PATTERN (required)
      The regex pattern to match the string(s) against.
  STRING (0 or more)
      The strings to check.

Options:
-a, --all 
        Specifies that all input strings must match.
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.
-v, --verbose 
        Prints additional information during command execution.

Examples:
$ -str-matches A

$ -str-matches A A B
A
$ -str-matches -v A A B
match: A
no match: B
$ -str-matches -a A A B
A
$ -str-matches -v -a A A B
match: A
no match: B
```

*Implementation:*
```bash
if [[ ! ${_STRING} ]]; then
    return 0
fi

local matchFound=false
local mismatchFound=false
local str
for str in ${_STRING[@]}; do
    if [[ $str =~ $_REGEX_PATTERN ]]; then
        if [[ $_verbose ]]; then
            echo "match: $str"
        else
            echo "$str"
        fi
        matchFound=true
        local i=1
        local n=${#BASH_REMATCH[*]}
        while [[ $i -lt $n ]]
        do
            echo "  capture[$i]: ${BASH_REMATCH[$i]}"
            let i++
        done
    else
        if [[ $_verbose ]]; then
            echo "no match: $str"
        fi
        mismatchFound=true
    fi
    shift
done
if [[ $_all ]]; then
    [[ $mismatchFound == "true" ]] && return 1 || return 0
else
    [[ $matchFound == "true" ]] && return 0 || return 1
fi
```


## <a name="-str-repeat"></a>-str-repeat

```
Usage: -str-repeat [OPTION]... STRING COUNT

Prints the given string multiple times.

Parameters:
  STRING (required)
      The string to repeat.
  COUNT (required)
      Number of times to repeat the string.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -str-repeat a 3
aaa
```

*Implementation:*
```bash
local spaces="$(printf "%${_COUNT}s" "")"
echo "${spaces// /${_STRING}}"
```


## <a name="-str-trim"></a>-str-trim

```
Usage: -str-trim [OPTION]... STRING

Prints the given string without leading and trailing spaces.

Parameters:
  STRING (required)
      The string to trim.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -str-trim "  abc  "
abc
```

*Implementation:*
```bash
echo ${_STRING}
```


## <a name="-str-upper"></a>-str-upper

```
Usage: -str-upper [OPTION]... STRING

Prints the given string in upper cases.

Parameters:
  STRING (required)
      The string to convert.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -str-upper aBcDeF
ABCDEF
```

*Implementation:*
```bash
echo "${1^^}"
```


## <a name="-strip-ansi"></a>-strip-ansi

```
Usage: -strip-ansi [OPTION]... [STRING]...

Removes any ANSI escape sequences from the given string or from stdin.

Parameters:
  STRING (0 or more)
      The strings to strip.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -strip-ansi $(echo -e '\033[4mThis is underlined\033[24m')
This is underlined
```

*Implementation:*
```bash
local ansiColors="([0-9]{1,2}(;[0-9]{1,2})?(;[0-9]{1,2})?)?[m|K]"
local ansiCursors1="[0-9]+[A-D]" # cursor up/down/right/left
local ansiCursors2="[su]" # save/restore cursor position
local ansiPattern="\x1B\[((${ansiColors})|(${ansiCursors1})|(${ansiCursors2}))"
if [[ ${_STRING} ]]; then
    echo "${_STRING[@]}" | sed -u -r "s/${ansiPattern}//g"
else
    sed -u -r "s/${ansiPattern}//g"
fi
```


## <a name="-substr-after"></a>-substr-after

```
Usage: -substr-after [OPTION]... SEARCH_IN SEARCH_FOR

Prints the substring after the first occurrence of SEARCH_FOR.

Parameters:
  SEARCH_IN (required)
      The string to search.
  SEARCH_FOR (required)
      The separator.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -substr-after 00aa11aa22 aa
11aa22
```

*Implementation:*
```bash
echo ${_SEARCH_IN#*${_SEARCH_FOR}}
```


## <a name="-substr-after-last"></a>-substr-after-last

```
Usage: -substr-after-last [OPTION]... SEARCH_IN SEARCH_FOR

Prints the substring after the last occurrence of SEARCH_FOR.

Parameters:
  SEARCH_IN (required)
      The string to search.
  SEARCH_FOR (required)
      The separator.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -substr-after-last 00aa11aa22 aa
22
```

*Implementation:*
```bash
echo "${_SEARCH_IN#${_SEARCH_IN%${_SEARCH_FOR}*}${_SEARCH_FOR}}"
```


## <a name="-substr-before"></a>-substr-before

```
Usage: -substr-before [OPTION]... SEARCH_IN SEARCH_FOR

Prints the substring before the first occurrence of SEARCH_FOR.

Parameters:
  SEARCH_IN (required)
      The string to search.
  SEARCH_FOR (required)
      The separator.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -substr-before 00aa11aa22 aa
00
```

*Implementation:*
```bash
echo "${_SEARCH_IN%%${_SEARCH_FOR}*}"
```


## <a name="-substr-before-last"></a>-substr-before-last

```
Usage: -substr-before-last [OPTION]... SEARCH_IN SEARCH_FOR

Prints the substring before the last occurrence of SEARCH_FOR.

Parameters:
  SEARCH_IN (required)
      The string to search.
  SEARCH_FOR (required)
      The separator.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -substr-before-last 00aa11aa00 aa
00aa11
```

*Implementation:*
```bash
echo "${_SEARCH_IN%${_SEARCH_FOR}*}"
```


## <a name="-substr-between"></a>-substr-between

```
Usage: -substr-between [OPTION]... SEARCH_IN PREFIX SUFFIX

Prints the substring between PREFIX and SUFFIX.

Parameters:
  SEARCH_IN (required)
      The string to search.
  PREFIX (required)
      The start separator.
  SUFFIX (required)
      The end separator.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.

Examples:
$ -substr-between 00aa11aa22aa00 aa aa
11
```

*Implementation:*
```bash
local withoutPrefix="${_SEARCH_IN#*${_PREFIX}}"
echo "${withoutPrefix%%${_SUFFIX}*}"
```


## <a name="-test-strings"></a>-test-strings

```
Usage: -test-strings [OPTION]...

Performs a selftest of all functions of this module by executing each function with option '--selftest'.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.
```

*Implementation:*
```bash
${BASH_FUNK_PREFIX:-}-ascii2hex --selftest && echo || return 1
${BASH_FUNK_PREFIX:-}-hex2ascii --selftest && echo || return 1
${BASH_FUNK_PREFIX:-}-normalize-path --selftest && echo || return 1
${BASH_FUNK_PREFIX:-}-str-join --selftest && echo || return 1
${BASH_FUNK_PREFIX:-}-str-lower --selftest && echo || return 1
${BASH_FUNK_PREFIX:-}-str-matches --selftest && echo || return 1
${BASH_FUNK_PREFIX:-}-str-repeat --selftest && echo || return 1
${BASH_FUNK_PREFIX:-}-str-trim --selftest && echo || return 1
${BASH_FUNK_PREFIX:-}-str-upper --selftest && echo || return 1
${BASH_FUNK_PREFIX:-}-strip-ansi --selftest && echo || return 1
${BASH_FUNK_PREFIX:-}-substr-after --selftest && echo || return 1
${BASH_FUNK_PREFIX:-}-substr-after-last --selftest && echo || return 1
${BASH_FUNK_PREFIX:-}-substr-before --selftest && echo || return 1
${BASH_FUNK_PREFIX:-}-substr-before-last --selftest && echo || return 1
${BASH_FUNK_PREFIX:-}-substr-between --selftest && echo || return 1
```


## <a name="license"></a>License

Copyright (c) 2015-2017 Vegard IT GmbH, http://vegardit.com

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

