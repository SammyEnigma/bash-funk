# Bash-Funk "misc" module

[//]: # (THIS FILE IS GENERATED BY BASH-FUNK GENERATOR)

The following statements are automatically executed when this module loads:

```bash
function -timeout() {
    if [[ $# < 2 || ${1:-} == "--help" ]]; then
        echo "Usage: ${FUNCNAME[0]} TIMEOUT COMMAND [ARG]..."
        echo "Executes the COMMAND and aborts if it does not finish within the given TIMEOUT in seconds."
        [[ ${1:-} == "--help" ]] && return 0 || return 1
    fi
    # see: http://mywiki.wooledge.org/BashFAQ/068
    perl -e 'alarm shift; exec @ARGV' "$@";
}
```

The following commands are available when this module is loaded:

1. [-help](#-help)
1. [-test-all](#-test-all)
1. [-test-misc](#-test-misc)
1. [-var-exists](#-var-exists)
1. [-wait](#-wait)

## <a name="-help"></a>-help

```
Usage: -help [OPTION]...

Prints the online help of all bash-funk commands.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.
```

*Implementation:*
```bash
for helpfunc in $(compgen -A function -- ${BASH_FUNK_PREFIX}-help-); do
    $helpfunc
done | sort
```


## <a name="-test-all"></a>-test-all

```
Usage: -test-all [OPTION]...

Executes the selftests of all loaded bash-funk commands.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.
```

*Implementation:*
```bash
for testfunc in $(compgen -A function -- ${BASH_FUNK_PREFIX}-test-); do
    if [[ $testfunc != "${BASH_FUNK_PREFIX}-test-all" ]]; then
        $testfunc || return 1
    fi
done
```


## <a name="-test-misc"></a>-test-misc

```
Usage: -test-misc [OPTION]...

Performs a selftest of all functions of this module by executing each function with option '--selftest'.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.
```

*Implementation:*
```bash
-help --selftest && echo || return 1
-test-all --selftest && echo || return 1
-var-exists --selftest && echo || return 1
-wait --selftest && echo || return 1
```


## <a name="-var-exists"></a>-var-exists

```
Usage: -var-exists [OPTION]... VARIABLE_NAME

Determines if the given variable is declared.

Parameters:
  VARIABLE_NAME (required)
      Name of the Bash variable to check.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.
-v, --verbose 
        Prints additional information during command execution.

Examples:
$ -var-exists USER

$ -var-exists -v USER
Bash variable 'USER' is exists.
$ -var-exists -v NON_EXISTANT_VARIABLE
Bash variable 'NON_EXISTANT_VARIABLE' does not exist.
```

*Implementation:*
```bash
if declare -p ${_VARIABLE_NAME} &>/dev/null; then
    [[ $_verbose ]] && echo "Bash variable '${_VARIABLE_NAME}' is exist." || true
    return 0
else
    [[ $_verbose ]] && echo "Bash variable '${_VARIABLE_NAME}' does not exist." || true
    return 1
fi
```


## <a name="-wait"></a>-wait

```
Usage: -wait [OPTION]... SECONDS

Waits for the given number of seconds or until the key 's' pressed.

Parameters:
  SECONDS (required)
      Number of seconds to wait.

Options:
    --help 
        Prints this help.
    --selftest 
        Performs a self-test.
```

*Implementation:*
```bash
echo -ne "Waiting for [$(date +%T --date=@$(($_SECONDS - 3600)))] until $(date +%T --date=@$(($(date +%s) + $_SECONDS))). Press [s] to skip: \033[9C"
for (( i = 0; i < $_SECONDS; i++ )); do
    # adding a \n new line character to the end of the line to make the output parseable by sed which is line oriented
    echo -ne "\033[9D\033[1;32m$(date +%T --date=@$(($_SECONDS - ${i} - 3600))) \033[0m\033[s\n\033[u"
    local char=
    read -s -n1 -t1 char || :
    [[ $char == "s" ]] && break
done
echo
```


## <a name="license"></a>License

Copyright (c) 2015-2017 Vegard IT GmbH, http://vegardit.com

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

